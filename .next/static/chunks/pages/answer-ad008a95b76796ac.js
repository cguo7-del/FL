(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[878],{361:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/answer",function(){return t(6491)}])},5981:function(e,n,t){"use strict";t.d(n,{G_:function(){return u},YX:function(){return d},r5:function(){return l},supabase:function(){return c},x0:function(){return i}});var r=t(1608),s=t(3454);let a=s.env.SUPABASE_URL||"https://crnfwlpcxrnqfgwqnmun.supabase.co",o=s.env.SUPABASE_ANON_KEY||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNybmZ3bHBjeHJucWZnd3FubXVuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUxNTAzMDQsImV4cCI6MjA3MDcyNjMwNH0.g_HmFQQiuGW2TZRzZ5gqCj098DZy6iwn_xQAE6kEUEI",c=(0,r.eI)(a,o),i=e=>{let n="";return("string"==typeof e?n=e:(null==e?void 0:e.message)?n=e.message:(null==e?void 0:e.error_description)&&(n=e.error_description),n.toLowerCase().includes("new password should be different"))?"新密码不能与旧密码相同":({"Invalid login credentials":"邮箱或密码错误","Email not confirmed":"邮箱未验证，请检查您的邮箱","User already registered":"该邮箱已注册","Password should be at least 6 characters":"密码至少需要6位字符","Signup requires a valid password":"注册需要有效的密码","Invalid email":"邮箱格式不正确","Email rate limit exceeded":"邮件发送频率过高，请稍后再试","Too many requests":"请求过于频繁，请稍后再试","Network request failed":"网络请求失败，请检查网络连接","User not found":"用户不存在","Email already taken":"该邮箱已被使用","Weak password":"密码强度不够，请使用更复杂的密码","New password should be different from the old password":"新密码不能与旧密码相同","new password should be different from the old password":"新密码不能与旧密码相同","Password update failed":"密码更新失败，请稍后重试","Session not found":"会话已过期，请重新获取重置链接","Invalid recovery token":"重置链接无效或已过期，请重新申请","Auth session missing":"认证会话缺失，请重新获取重置链接"})[n]||n||"发生未知错误，请稍后重试"},l={async signUp(e,n,t){try{let{data:r,error:s}=await c.auth.signUp({email:e,password:n,options:{data:{username:t},emailRedirectTo:"".concat("https://fanglue.org","/auth")}});if(s)throw Error(i(s));return r}catch(e){throw Error(i(e))}},async signIn(e,n){try{let{data:t,error:r}=await c.auth.signInWithPassword({email:e,password:n});if(r)throw Error(i(r));return t}catch(e){throw Error(i(e))}},async signOut(){try{let{error:e}=await c.auth.signOut();if(e)throw Error(i(e));return!0}catch(e){throw Error(i(e))}},async getCurrentUser(){try{let{data:{user:e},error:n}=await c.auth.getUser();if(n)throw Error(i(n));return e}catch(e){throw Error(i(e))}},onAuthStateChange:e=>c.auth.onAuthStateChange(e)},d={supabase:c,async insert(e,n){let{data:t,error:r}=await c.from(e).insert(n).select();if(r)throw console.error("插入数据错误:",r),r;return t},async select(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=c.from(e).select("*");Object.entries(n).forEach(e=>{let[n,r]=e;t=t.eq(n,r)});let{data:r,error:s}=await t;if(s)throw console.error("查询数据错误:",s),s;return r},async update(e,n,t){let{data:r,error:s}=await c.from(e).update(t).eq("id",n).select();if(s)throw console.error("更新数据错误:",s),s;return r},async delete(e,n){let{error:t}=await c.from(e).delete().eq("id",n);if(t)throw console.error("删除数据错误:",t),t;return!0},async testConnection(){try{let{data:e,error:n}=await c.rpc("version");if(n){let{error:e}=await c.from("test_connection_table").select("*").limit(1);if(e&&("PGRST116"===e.code||"42P01"===e.code))return console.log("数据库连接成功!"),!0;return console.error("数据库连接测试失败:",e||n),!1}return console.log("数据库连接成功!"),!0}catch(e){return console.error("连接测试异常:",e),!1}}},u={async saveCollection(e,n,t){try{let{data:r,error:s}=await c.from("user_collections").insert({user_id:e,question:n,answer:t}).select();if(s)throw console.error("收藏保存失败:",s),s;return r[0]}catch(e){throw console.error("收藏操作异常:",e),e}},async getUserCollections(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;try{let r=(n-1)*t,{data:s,error:a,count:o}=await c.from("user_collections").select("*",{count:"exact"}).eq("user_id",e).order("updated_at",{ascending:!1}).range(r,r+t-1);if(a)throw console.error("获取收藏列表失败:",a),a;return{data:s||[],total:o||0,page:n,pageSize:t,totalPages:Math.ceil((o||0)/t)}}catch(e){throw console.error("获取收藏列表异常:",e),e}},async deleteCollections(e){try{let{error:n}=await c.from("user_collections").delete().in("id",e);if(n)throw console.error("删除收藏失败:",n),n;return!0}catch(e){throw console.error("删除收藏异常:",e),e}},async checkIfCollected(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{let r=c.from("user_collections").select("id").eq("user_id",e).eq("question",n);t&&(r=r.ilike("answer","%".concat(t,"%")));let{data:s,error:a}=await r.limit(1);if(a)throw console.error("检查收藏状态失败:",a),a;return s&&s.length>0}catch(e){throw console.error("检查收藏状态异常:",e),e}}}},6491:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return l}});var r=t(5893),s=t(7294),a=t(1163),o=t(2749),c=t.n(o),i=t(5981);function l(){var e;let n=(0,a.useRouter)(),{question:t,strategies:o}=n.query,[l,d]=(0,s.useState)(null),[u,h]=(0,s.useState)(!0),[_,w]=(0,s.useState)(null),[m,f]=(0,s.useState)(0),[p,g]=(0,s.useState)(null),[y,N]=(0,s.useState)(!1),[x,A]=(0,s.useState)(!1),[j,v]=(0,s.useState)(!1);(0,s.useEffect)(()=>{if(t){let e=setInterval(()=>{f(e=>e>=90?e:e+1)},100);return C().finally(()=>{clearInterval(e),f(100),setTimeout(()=>{h(!1)},200)}),()=>clearInterval(e)}},[t]),(0,s.useEffect)(()=>{(async()=>{try{let e=await i.r5.getCurrentUser();g(e)}catch(e){g(null)}})();let{data:{subscription:e}}=i.r5.onAuthStateChange((e,n)=>{"SIGNED_IN"===e?(g((null==n?void 0:n.user)||null),l&&setTimeout(()=>b(),500)):"SIGNED_OUT"===e&&(g(null),A(!1))});return()=>e.unsubscribe()},[]);let k=async()=>{try{await i.r5.signOut(),N(!1)}catch(e){console.error("登出错误:",e)}},b=async()=>{if(p&&l)try{let e=await i.G_.checkIfCollected(p.id,t,l.探源.原文);A(e)}catch(e){console.error("检查收藏状态失败:",e)}},S=async()=>{if(!p){alert("请先登录后再收藏"),n.push("/auth");return}if(l){v(!0);try{if(x){let e=(await i.G_.getUserCollections(p.id)).data.find(e=>{if(e.question!==t)return!1;try{let n=JSON.parse(e.answer);return n.探源&&n.探源.原文===l.探源.原文}catch(n){return e.answer.includes(l.探源.原文)}});e&&(await i.G_.deleteCollections([e.id]),A(!1),alert("已取消收藏"))}else{let e=JSON.stringify(l);await i.G_.saveCollection(p.id,t,e),A(!0),alert("收藏成功！")}}catch(e){console.error("收藏操作失败:",e),alert("操作失败，请重试")}finally{v(!1)}}},C=async()=>{h(!0),w(null);try{let e=o?o.split(","):[],n=[];if(e&&e.length>0){let{data:t,error:r}=await i.YX.supabase.from("book_library").select("*").in("strategy_category",e);r?(console.error("查询书籍数据失败:",r),n=[]):n=t||[]}else{let{data:e,error:t}=await i.YX.supabase.from("book_library").select("*");t?(console.error("查询书籍数据失败:",t),n=[]):n=e||[]}let r=await I(t,n,e);d(r),A(!1)}catch(e){console.error("生成答案失败:",e),w("生成答案时出现错误，请稍后重试。")}finally{h(!1)}},I=async(e,n,t)=>{let r=n&&n.length>0?n[Math.floor(Math.random()*n.length)]:null;console.log("调试 - randomBook对象:",r),console.log("调试 - randomBook字段:",r?Object.keys(r):"null");let s=async n=>{if(console.log("调试 - getOriginalText收到的book:",n),console.log("调试 - book.book_name:",n?n.book_name:"book为null"),console.log("调试 - book.书籍名称:",n?n.书籍名称:"book为null"),!n||!n.book_name&&!n.书籍名称)return console.log("调试 - 使用默认文本，原因：",n?"书籍名称字段为空":"book为null"),{text:"智者顺时而谋，愚者逆势而动。",bookName:"古代典籍",chapterName:"第一章"};let t=await F(e,n);return console.log("调试 - selectIntelligentQuote返回:",t),t},a=e=>e&&e.bookName?"".concat(e.bookName,"\xb7").concat(e.chapterName||"经典篇章"):"古代典籍\xb7第一章";try{"请基于以下信息生成一个结构化的智慧解答：\n\n用户问题：".concat(e,"\n\n选择的方略经纬：").concat(t&&t.length>0?t.join("、"):"无特定方向","\n\n引用书籍：").concat(r?"《".concat(r.book_name,"》"):"古代典籍","\n书籍内容：").concat(r?r.chapter_content:"古代智慧典籍","\n\n请按照以下结构生成答案，每部分都要有实质性内容，不要使用模板化语言：\n\n1. 探源部分：\n   - 从书籍中提取1-3句相关原文\n   - 深层分析用户问题背后的真实困扰（使用第二人称）\n\n2. 析局部分：\n   - 基于古籍智慧的逻辑分析\n   - 相关的历史典故或案例\n\n3. 行策部分：\n   - 核心策略建议\n   - 具体可操作的方法\n   - 风险提醒和注意事项\n\n请确保内容原创、深度、实用，体现古代智慧在现代问题中的应用。");let n=await s(r),o=await E(e,r,t,n.text),c=await q(e,r);return{探源:{原文:n.text,出处:a(n),问题转述:c.rephrased,深层分析:c.deepAnalysis},析局:{逻辑分析:o.logicAnalysis,历史案例:o.historicalCase},行策:{核心策略:o.coreStrategy,具体方法:o.detailedMethod,风险提醒:o.riskWarning}}}catch(t){console.error("生成答案内容失败:",t);let n=await s(r);return{探源:{原文:n.text,出处:a(n),问题转述:e,深层分析:"您的问题反映了在复杂情况下寻求最佳解决方案的智慧需求。"},析局:{逻辑分析:"古人智慧告诉我们，面对挑战时需要深入分析局势，找到关键要素。",历史案例:"历史上许多智者都曾面临类似挑战，他们的经验值得我们借鉴。"},行策:{核心策略:"基于古代智慧，建议采用稳健而灵活的策略。",具体方法:"具体实施时，需要结合实际情况，循序渐进地推进。",风险提醒:"在执行过程中，需要时刻保持警觉，及时调整策略。"}}}},T=async e=>{try{let n=await fetch("/api/deepseek",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:e})});if(!n.ok)throw console.error("API调用失败:",n.status,n.statusText),Error("API调用失败: ".concat(n.status));return(await n.json()).content||"生成内容失败"}catch(n){if(console.error("DeepSeek API调用错误:",n),e.includes("问题概况"))return"这是一个关于策略决策的重要问题，需要综合考虑多个因素来制定最佳方案。";if(e.includes("核心分析"))return"通过深入分析问题的本质和关键要素，我们可以找到解决问题的核心路径。";if(e.includes("历史案例"))return"历史上类似的情况告诉我们，成功的关键在于准确判断形势并采取适当的行动。";if(e.includes("逻辑分析"))return"从逻辑角度分析，我们需要理清因果关系，找出问题的根源和解决方案。";else if(e.includes("高能摘要"))return"核心要点：抓住关键机会，制定明确策略，果断执行行动计划。";else if(e.includes("详细方法"))return"具体实施步骤：1. 深入调研分析 2. 制定行动方案 3. 分步骤执行 4. 持续优化调整";else if(e.includes("风险示警"))return"需要注意的风险：时机把握、资源配置、执行力度等关键因素可能影响最终效果。";return"智能分析生成中，请稍候..."}},q=async(e,n)=>{try{let n=await T("请对以下用户问题进行重新表述和深层分析：\n\n用户问题：".concat(e,'\n\n要求：\n1. 首先用一句话重新表述用户的问题，让这个问题看起来更加简洁直接一针见血\n2. 然后分析用户背后的真实困扰，用第二人称增强互动感\n3. 整体内容放在一段中，不要分开\n4. 不要使用破折号（—）等符号\n5. 参考示例风格："老板总是把棘手的项目推给你，你应该怎么办？你担心的不是任务本身，而是接了之后搞砸，被老板当成背锅侠，同时失去在团队的信任和话语权。你真正想知道的是，既不能硬拒绝，又不想做无谓牺牲，该如何两全？"\n\n请直接返回重新表述的问题和深层分析内容，不要添加其他说明。'));if(n&&"智能分析生成中，请稍候..."!==n&&!n.includes("生成内容失败")){let t=n.trim(),r=t.split(/[？?]/);if(r.length>=2){let e=r[0]+"？",n=r.slice(1).join("？").replace(/^[？?]/,"").trim();return{rephrased:e,deepAnalysis:n||t}}return{rephrased:e,deepAnalysis:t}}return B(e)}catch(n){return console.error("生成探源内容失败:",n),B(e)}},B=e=>{let n="困难";for(let[t,r]of Object.entries({工作:["职场","同事","老板","项目","任务","升职","跳槽"],管理:["团队","下属","领导","决策","管理","协调"],人际:["朋友","家人","关系","沟通","矛盾","冲突"],选择:["选择","决定","犹豫","纠结","方向","道路"],困难:["困难","挫折","失败","压力","焦虑","迷茫"]}))if(r.some(n=>e.includes(n))){n=t;break}let t={工作:{rephrased:"".concat(e.replace(/[？?]$/,""),"，你该如何应对？"),deepAnalysis:"你担心的不只是眼前的问题，而是这件事可能影响你在职场中的地位和发展。你真正想知道的是，如何在维护自己利益的同时，又不破坏与同事和上级的关系。"},管理:{rephrased:"面对".concat(e.replace(/[？?]$/,""),"的情况，你应该怎么处理？"),deepAnalysis:"你的困扰不在于不知道该做什么，而在于如何平衡各方利益，既要达成目标，又要维护团队和谐。你真正需要的是一套既有效又不伤和气的解决方案。"},人际:{rephrased:"".concat(e.replace(/[？?]$/,""),"，你该如何处理这种关系？"),deepAnalysis:"你在意的不是对错，而是如何在坚持自己原则的同时，不伤害彼此的感情。你真正想要的是既能解决问题，又能维护关系的双赢方案。"},选择:{rephrased:"面临".concat(e.replace(/[？?]$/,""),"的选择，你该如何决定？"),deepAnalysis:"你的纠结不在于选项本身，而在于担心选错了方向会后悔。你真正需要的是一个清晰的判断标准，让你能够坚定地做出选择并承担结果。"},困难:{rephrased:"遇到".concat(e.replace(/[？?]$/,""),"的困难，你该怎么办？"),deepAnalysis:"你的焦虑不只是来自困难本身，更来自对未知结果的担忧。你真正想要的是一种面对困难的勇气和方法，让你能够从容应对各种挑战。"}},r=t[n]||t["困难"];return{rephrased:r.rephrased,deepAnalysis:r.deepAnalysis}},E=async(e,n,t,r)=>{try{let s=n?n.book_name:"古代典籍",a=t&&t.length>0?t.join("、"):"综合智慧",o='用户问题："'.concat(e,'"\n参考古籍：').concat(s,"\n方略经纬：").concat(a,"\n\n请简洁概况用户问题的核心，并分析用户背后的真实困扰。要求：\n1. 用1-2句话概括问题核心\n2. 用1-2句话分析真实困扰\n3. 语言简洁有力，直击要害"),c=await J(e,n,t,r),i=[T(o),Promise.resolve(c),L(e,n,r,c),O(e,n,t,r,c),U(e,n,t,r,c),M(e,n,r,c)],[l,d,u,h,_,w]=await Promise.allSettled(i);return{deepAnalysis:"fulfilled"===l.status?l.value:"问题核心在于决策困境，真实困扰是缺乏明确方向。",logicAnalysis:"fulfilled"===d.status?d.value:"古籍智慧指引方向，核心在于顺势而为。",historicalCase:"fulfilled"===u.status?u.value:"春秋时期，管仲辅佐齐桓公，面对内忧外患，不急于求成，而是先稳内政、后图霸业，最终成就一代霸主。",coreStrategy:"fulfilled"===h.status?h.value:"先稳后进，以静制动。明确目标，分步实施，借势而为，化危为机。",detailedMethod:"fulfilled"===_.status?_.value:"第一步：明确目标，理清思路。第二步：分析现状，找准问题根源。第三步：制定计划，分步实施。",riskWarning:"fulfilled"===w.status?w.value:"切忌急功近利，欲速则不达。过程中需防范利益冲突，保持初心不变。"}}catch(e){return console.error("生成智能答案时出错:",e),{deepAnalysis:"问题核心在于决策困境，真实困扰是缺乏明确方向。",logicAnalysis:"古籍智慧指引方向，核心在于顺势而为。",historicalCase:"春秋时期，管仲辅佐齐桓公，面对内忧外患，不急于求成，而是先稳内政、后图霸业，最终成就一代霸主。",coreStrategy:"先稳后进，以静制动。明确目标，分步实施，借势而为，化危为机。",detailedMethod:"第一步：明确目标，理清思路。第二步：分析现状，找准问题根源。第三步：制定计划，分步实施。",riskWarning:"切忌急功近利，欲速则不达。过程中需防范利益冲突，保持初心不变。"}}},J=async(e,n,t,r)=>{if(!r)return"子女应主动关怀父母，这是为人子女的根本责任。";let s='原文："'.concat(r,'"\n用户问题："').concat(e,'"\n\n请用1-2句话简要拆解这段原文的核心逻辑，要求：\n1. 直接从核心逻辑开始，不要加"原文核心是"、"这段话说的是"等开头\n2. 语言简洁有力，现代化表达\n3. 与用户问题紧密相关\n4. 不要使用破折号等符号\n5. 用现代语言重新表达古文的智慧\n\n参考示例格式："子女应主动关怀父母，冬季保暖夏季清凉，晚上安顿早上问安。这提醒你假期选择：拓宽视野固然重要，但亲情陪伴是为人子女的根本责任。"');return await T(s)||"子女应主动关怀父母，这是为人子女的根本责任，把握时机与人心。"},L=async(e,n,t,r)=>{let s='原文："'.concat(t,'"\n核心逻辑：').concat(r,'\n用户问题："').concat(e,'"\n\n请提供一个简短、生动、有画面感的真实历史案例来侧面论证这个核心逻辑。要求：\n1. 必须是真实的历史人物和事件，不能虚构\n2. 与原文的核心逻辑高度相关，能够印证这个智慧\n3. 语言生动有画面感，有具体的人物、时间、地点、行为细节\n4. 控制在80-120字之间\n5. 不要使用破折号、引号等符号\n6. 突出智慧策略的巧妙运用和效果\n7. 要有具体的历史背景和结果\n\n参考示例格式：明成祖永乐年间，建文旧臣方孝孺被朱棣派去劝降南方叛军，他并不急着传旨，而是要求叛军面见皇帝，把时间拖到朱棣亲自带兵赶来。叛军以为有谈判机会，松懈戒备，结果被朱棣突袭全歼');return await T(s)||"春秋时期，管仲辅佐齐桓公，面对内忧外患，不急于求成，而是先稳内政、后图霸业，最终成就一代霸主。其智慧在于急事缓做，缓事急做。"},O=async(e,n,t,r,s)=>{let a=t&&t.length>0?t.join("、"):"综合智慧",o='用户问题："'.concat(e,'"\n原文："').concat(r,'"\n逻辑分析："').concat(s,'"\n方略经纬：').concat(a,'\n\n请给出一个快准狠的高能摘要答案，作为解决问题的核心策略。要求：\n1. 用1-2句话给出直接有效的解决方案\n2. 语言简洁有力，直击要害\n3. 基于原文和逻辑分析的智慧\n4. 控制在60字以内\n5. 参考示例："所以，如果老板把高风险项目甩给你，先别急着全盘接，让他亲自站台背书，你只做执行的刀，责任在他。"');return await T(o)||"先稳后进，以静制动。明确目标，分步实施，借势而为，化危为机。"},U=async(e,n,t,r,s)=>{let a=t&&t.length>0?t.join("、"):"综合智慧",o='用户问题："'.concat(e,'"\n原文："').concat(r,'"\n逻辑分析："').concat(s,'"\n方略经纬：').concat(a,'\n\n请用第二人称详细说明具体的解决方法，要求：\n1. 使用第二人称（你），有画面感和代入感\n2. 不要列步骤一二三四，要自然流畅的叙述\n3. 具体可操作，有细节描述\n4. 基于原文智慧和逻辑分析\n5. 控制在200-300字\n6. 直接给出具体方法，不要包含任何改写说明、格式说明或元描述\n7. 开头要自然多样化，避免重复使用"想象一下"，可以用"你可以"、"不妨"、"关键在于"、"首先"、"最好的做法是"等多种开头方式\n8. 参考示例风格："你可以笑着抛个球：\'这个项目牵涉到好几个部门，您帮我们定个方向吧。\'老板一听，自然就站到台前成了\'项目主人\'。之后每次开关键会议，你都先请他开场定调，而你在一旁安静记录细节、补位执行——这样，大家心里都默认，他是最终拍板的人。在项目推进的过程中，任何一点风险，你都第一时间写成邮件或会议纪要抄送老板，让证据落在纸面上，也给自己留条后路。与此同时，你还可以刻意创造一些可见的小成绩——比如提前交付一个阶段成果、或者悄悄解决一个老大难问题——让大家记住你的价值，但不要抢风头，也不要急着当"全能救世主"。"');return await T(o)||"你可以先主动找对方沟通，了解真实想法和顾虑。在交流过程中，保持开放的心态，认真倾听对方的观点。然后寻找双方的共同利益点，从这个角度提出解决方案。同时，你要展现出诚意和耐心，让对方感受到你的善意。关键在于以诚待人，以理服人。"},M=async(e,n,t,r)=>{let s='用户问题："'.concat(e,'"\n原文："').concat(t,'"\n逻辑分析："').concat(r,'"\n\n请给出1-2句话的风险提醒，说明用这个方法需要注意的方向。要求：\n1. 基于原文智慧和逻辑分析\n2. 指出关键风险点和注意事项\n3. 语言温和但有警示作用，用类似"不过..."开头，避免"需警惕"等生硬表达\n4. 控制在80字以内\n5. 可以引用历史教训作为反面例子\n6. 直接给出风险提醒，不要包含任何改写说明、格式说明或元描述\n7. 参考示例："不过要记住，这不是\'甩锅不干\'。北宋末年王安石误判局势，对辽军挑衅一味按兵不动，结果士气崩溃，丢了燕云十六州。把责任上移的前提，是你自己也要在执行中贡献成果，否则你会被看成推卸责任。"');return await T(s)||"不过切忌急功近利，欲速则不达。过程中需防范利益冲突，保持初心不变。"},P=async(e,n)=>{try{let t=await fetch("/api/search-quotes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:e,strategy_category:n})});if(t.ok){let e=await t.json();if(e.quote&&e.quote.length>5)return{text:e.quote,source:"".concat(e.bookName,"\xb7").concat(e.chapterName),bookName:e.bookName,chapterName:e.chapterName,fromNetworkSearch:e.fromNetworkSearch}}}catch(e){console.error("网络搜索失败:",e)}return{text:"智者顺时而谋，愚者逆势而动。",source:"智慧经典\xb7第一章",bookName:"智慧经典",chapterName:"第一章",fromNetworkSearch:!1}},F=async(e,n)=>n&&(n.book_name||n.书籍名称)?await P(e,n.strategy_category):{text:"智者顺时而谋，愚者逆势而动。",source:"古代智慧"};return u?(0,r.jsx)("div",{className:c().container,children:(0,r.jsxs)("div",{className:c().loading,children:[(0,r.jsx)("div",{className:c().loadingSpinner,"data-progress":"".concat(m,"%")}),(0,r.jsx)("p",{children:"方略近在眼前..."})]})}):_?(0,r.jsx)("div",{className:c().container,children:(0,r.jsxs)("div",{className:c().error,children:[(0,r.jsx)("h2",{children:"生成答案时出现错误"}),(0,r.jsx)("p",{children:_}),(0,r.jsx)("button",{onClick:()=>n.back(),className:c().backButton,children:"返回重试"})]})}):(0,r.jsxs)("div",{className:c().container,children:[(0,r.jsxs)("nav",{className:c().navbar,children:[(0,r.jsx)("div",{className:c().brand,onClick:()=>n.push("/"),style:{cursor:"pointer"},children:"方略 Fanglue"}),(0,r.jsx)("div",{className:c().navLinks,children:p?(0,r.jsxs)("div",{className:c().userMenu,children:[(0,r.jsxs)("button",{className:c().userButton,onClick:()=>N(!y),children:[(null===(e=p.user_metadata)||void 0===e?void 0:e.username)||p.email,(0,r.jsx)("span",{className:c().dropdownArrow,children:"▼"})]}),y&&(0,r.jsxs)("div",{className:c().dropdown,children:[(0,r.jsx)("button",{className:c().dropdownItem,onClick:()=>{N(!1),n.push("/profile")},children:"个人资料"}),(0,r.jsx)("button",{className:c().dropdownItem,onClick:()=>{N(!1),n.push("/collection")},children:"历问历答"}),(0,r.jsx)("hr",{className:c().dropdownDivider}),(0,r.jsx)("button",{className:c().dropdownItem,onClick:k,children:"退出登录"})]})]}):(0,r.jsx)("button",{className:c().authBtn,onClick:()=>n.push("/auth"),children:"注册/登录"})})]}),(0,r.jsxs)("main",{className:c().mainContent,children:[l&&(0,r.jsxs)("article",{className:c().answerContainer,children:[(0,r.jsxs)("section",{className:c().section,children:[(0,r.jsxs)("h2",{className:c().sectionTitle,children:[(0,r.jsx)("img",{src:"/icons/explore-source.svg",alt:"探源",className:c().sectionIcon}),"探源"]}),(0,r.jsxs)("blockquote",{className:c().quote,children:[(0,r.jsxs)("p",{className:c().quoteText,children:['"',l.探源.原文,'"']}),(0,r.jsxs)("cite",{className:c().quoteSource,children:["-",l.探源.出处]})]}),(0,r.jsx)("div",{className:c().analysis,children:(0,r.jsx)("p",{children:l.探源.深层分析})})]}),(0,r.jsxs)("section",{className:c().section,children:[(0,r.jsxs)("h2",{className:c().sectionTitle,children:[(0,r.jsx)("img",{src:"/icons/analyze-situation.svg",alt:"析局",className:c().sectionIcon}),"析局"]}),(0,r.jsx)("p",{className:c().logicAnalysis,children:l.析局.逻辑分析}),(0,r.jsx)("aside",{className:c().historicalCase,children:(0,r.jsx)("p",{className:c().caseText,children:l.析局.历史案例})})]}),(0,r.jsxs)("section",{className:c().section,children:[(0,r.jsxs)("h2",{className:c().sectionTitle,children:[(0,r.jsx)("img",{src:"/icons/execute-strategy.svg",alt:"行策",className:c().sectionIcon}),"行策"]}),(0,r.jsx)("div",{className:c().coreStrategy,children:(0,r.jsx)("p",{className:c().strategyHighlight,children:l.行策.核心策略})}),(0,r.jsx)("div",{className:c().detailedMethod,children:(0,r.jsx)("p",{className:c().methodText,children:l.行策.具体方法})}),(0,r.jsx)("div",{className:c().riskWarning,children:(0,r.jsx)("p",{className:c().warningText,children:l.行策.风险提醒})})]})]}),l&&(0,r.jsxs)("div",{className:c().actionButtons,children:[(0,r.jsxs)("button",{className:c().actionBtn,onClick:()=>{d(null),h(!0),f(0);let e=setInterval(()=>{f(e=>e>=90?e:e+1)},100);C().finally(()=>{clearInterval(e),f(100),setTimeout(()=>{h(!1)},200)})},children:[(0,r.jsx)("img",{src:"/icons/refresh.svg",alt:"重新生成",className:c().actionIcon}),"重新生成答案"]}),(0,r.jsxs)("button",{className:c().actionBtn,onClick:()=>n.push("/ask"),children:[(0,r.jsx)("img",{src:"/icons/question.svg",alt:"提问",className:c().actionIcon}),"提出新问题"]}),(0,r.jsxs)("button",{className:"".concat(c().actionBtn," ").concat(x?c().collected:""),onClick:S,disabled:j,style:{backgroundColor:x?"#d4a574":"#fff",color:x?"#fff":"#666",borderColor:x?"#d4a574":"#ddd"},children:[(0,r.jsx)("img",{src:x?"/icons/heart-filled.svg":"/icons/heart.svg",alt:x?"已收藏":"收藏",className:c().actionIcon}),j?"处理中...":x?"已收藏":"收藏此策"]}),(0,r.jsxs)("button",{className:c().actionBtn,onClick:()=>window.print(),children:[(0,r.jsx)("img",{src:"/icons/print.svg",alt:"打印",className:c().actionIcon}),"打印保存"]})]})]}),(0,r.jsxs)("footer",{className:c().footerSection,children:[(0,r.jsx)("div",{className:c().footerTitle,children:"让千载经略，为你今日一策"}),(0,r.jsxs)("div",{className:c().footerButtons,children:[(0,r.jsx)("a",{href:"#",className:c().footerBtn,title:"功能开发中，敬请期待",children:"众议百解"}),(0,r.jsx)("a",{href:"#",className:c().footerBtn,title:"功能开发中，敬请期待",children:"一日一策"}),(0,r.jsx)("a",{href:"/collection",className:c().footerBtn,children:"历问历答"})]}),(0,r.jsxs)("div",{className:c().footerNavigation,children:[(0,r.jsx)("span",{className:c().copyright,children:"\xa9 2025 Fanglue.org"}),(0,r.jsx)("span",{className:c().navSeparator,children:"|"}),(0,r.jsx)("a",{href:"/about",className:c().footerNavLink,children:"关于我们"}),(0,r.jsx)("span",{className:c().navSeparator,children:"|"}),(0,r.jsx)("a",{href:"/contact",className:c().footerNavLink,children:"联系我们"}),(0,r.jsx)("span",{className:c().navSeparator,children:"|"}),(0,r.jsx)("a",{href:"/advertise",className:c().footerNavLink,children:"广告合作"}),(0,r.jsx)("span",{className:c().navSeparator,children:"|"}),(0,r.jsx)("a",{href:"/privacy-policy",className:c().footerNavLink,children:"隐私政策"}),(0,r.jsx)("span",{className:c().navSeparator,children:"|"}),(0,r.jsx)("a",{href:"/terms",className:c().footerNavLink,children:"服务条款"})]})]})]})}},2749:function(e){e.exports={container:"Answer_container__sZElH",navbar:"Answer_navbar__84uBn",brand:"Answer_brand__F0G_T",navLinks:"Answer_navLinks__UM0ps",navLink:"Answer_navLink__UUfnZ",authBtn:"Answer_authBtn__T7hHn",userMenu:"Answer_userMenu__1_J7w",userButton:"Answer_userButton__nluhn",dropdownArrow:"Answer_dropdownArrow__v0unv",dropdown:"Answer_dropdown__y_4Lh",dropdownFadeIn:"Answer_dropdownFadeIn__AWY3V",dropdownItem:"Answer_dropdownItem__F4HYw",dropdownDivider:"Answer_dropdownDivider__KxpV6",mainContent:"Answer_mainContent__BYWrB",questionSection:"Answer_questionSection__GgARw",questionTitle:"Answer_questionTitle__OqVYn",questionText:"Answer_questionText__rSCS9",answerContainer:"Answer_answerContainer__QaDzU",section:"Answer_section__5gx4O",sectionTitle:"Answer_sectionTitle__cUVEu",sectionIcon:"Answer_sectionIcon__vJmVl",sectionContent:"Answer_sectionContent__9BHcE",quote:"Answer_quote__ximbz",quoteText:"Answer_quoteText__ZCa1F",quoteSource:"Answer_quoteSource__3m_JY",analysis:"Answer_analysis__I0JQE",questionRestate:"Answer_questionRestate__Ju_bk",deepAnalysis:"Answer_deepAnalysis__KTJRJ",logicAnalysis:"Answer_logicAnalysis__jCSP2",historicalCase:"Answer_historicalCase__1f8lJ",caseText:"Answer_caseText__nF_RY",coreStrategy:"Answer_coreStrategy__1D01F",strategyHighlight:"Answer_strategyHighlight__jFdtK",detailedMethod:"Answer_detailedMethod__7QLR_",methodText:"Answer_methodText__XKkz8",riskWarning:"Answer_riskWarning__EgZXX",warningText:"Answer_warningText__2EvVD",loading:"Answer_loading__pGSXr",loadingSpinner:"Answer_loadingSpinner__0jss9",spin:"Answer_spin__VjJzd",counterRotate:"Answer_counterRotate__pLkW5",error:"Answer_error__NiLdL",backButton:"Answer_backButton__iKUmo",footerSection:"Answer_footerSection__AYNLu",footerTitle:"Answer_footerTitle__eHdL1",footerButtons:"Answer_footerButtons__zVgA5",footerBtn:"Answer_footerBtn__08cMQ",footerNavigation:"Answer_footerNavigation__kiq4P",copyright:"Answer_copyright__bsmsw",navSeparator:"Answer_navSeparator__8iYE_",footerNavLink:"Answer_footerNavLink__9zfCO",actionButtons:"Answer_actionButtons__DYYHc",actionBtn:"Answer_actionBtn__sJ_F6",collected:"Answer_collected__FLJqW",actionIcon:"Answer_actionIcon__P0MKx"}},1163:function(e,n,t){e.exports=t(2937)}},function(e){e.O(0,[608,774,888,179],function(){return e(e.s=361)}),_N_E=e.O()}]);