(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[878],{361:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/answer",function(){return t(6491)}])},5981:function(e,n,t){"use strict";t.d(n,{Y:function(){return a}});let s=(0,t(1608).eI)("https://crnfwlpcxrnqfgwqnmun.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNybmZ3bHBjeHJucWZnd3FubXVuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUxNTAzMDQsImV4cCI6MjA3MDcyNjMwNH0.g_HmFQQiuGW2TZRzZ5gqCj098DZy6iwn_xQAE6kEUEI"),a={supabase:s,async insert(e,n){let{data:t,error:a}=await s.from(e).insert(n).select();if(a)throw console.error("插入数据错误:",a),a;return t},async select(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=s.from(e).select("*");Object.entries(n).forEach(e=>{let[n,s]=e;t=t.eq(n,s)});let{data:a,error:r}=await t;if(r)throw console.error("查询数据错误:",r),r;return a},async update(e,n,t){let{data:a,error:r}=await s.from(e).update(t).eq("id",n).select();if(r)throw console.error("更新数据错误:",r),r;return a},async delete(e,n){let{error:t}=await s.from(e).delete().eq("id",n);if(t)throw console.error("删除数据错误:",t),t;return!0},async testConnection(){try{let{data:e,error:n}=await s.rpc("version");if(n){let{error:e}=await s.from("test_connection_table").select("*").limit(1);if(e&&("PGRST116"===e.code||"42P01"===e.code))return console.log("数据库连接成功!"),!0;return console.error("数据库连接测试失败:",e||n),!1}return console.log("数据库连接成功!"),!0}catch(e){return console.error("连接测试异常:",e),!1}}}},6491:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return l}});var s=t(5893),a=t(7294),r=t(1163),i=t(2749),c=t.n(i),o=t(5981);function l(){let e=(0,r.useRouter)(),{question:n,strategies:t}=e.query,[i,l]=(0,a.useState)(null),[u,_]=(0,a.useState)(!0),[d,h]=(0,a.useState)(null),[w,f]=(0,a.useState)(0);(0,a.useEffect)(()=>{if(n){let e=setInterval(()=>{f(e=>e>=90?e:e+1)},100);return m().finally(()=>{clearInterval(e),f(100),setTimeout(()=>{_(!1)},200)}),()=>clearInterval(e)}},[n]);let m=async()=>{_(!0),h(null);try{let e=t?t.split(","):[],s=[];if(e&&e.length>0){let{data:n,error:t}=await o.Y.supabase.from("book_library").select("*").in("strategy_category",e);t?(console.error("查询书籍数据失败:",t),s=[]):s=n||[]}else{let{data:e,error:n}=await o.Y.supabase.from("book_library").select("*");n?(console.error("查询书籍数据失败:",n),s=[]):s=e||[]}let a=await x(n,s,e);l(a)}catch(e){console.error("生成答案失败:",e),h("生成答案时出现错误，请稍后重试。")}},x=async(e,n,t)=>{let s=n&&n.length>0?n[Math.floor(Math.random()*n.length)]:null,a=async n=>n&&n.章节内容&&"string"==typeof n.章节内容?(await T(e,n)).text:"古人云：'知己知彼，百战不殆。'",r=e=>e&&e.书籍名称&&e.章节名称?"《".concat(e.书籍名称,"\xb7").concat(e.章节名称,"》"):"《古代典籍》";try{"请基于以下信息生成一个结构化的智慧解答：\n\n用户问题：".concat(e,"\n\n选择的方略经纬：").concat(t&&t.length>0?t.join("、"):"无特定方向","\n\n引用书籍：").concat(s?"《".concat(s.书籍名称,"》"):"古代典籍","\n书籍内容：").concat(s?s.章节内容:"古代智慧典籍","\n\n请按照以下结构生成答案，每部分都要有实质性内容，不要使用模板化语言：\n\n1. 探源部分：\n   - 从书籍中提取1-3句相关原文\n   - 深层分析用户问题背后的真实困扰（使用第二人称）\n\n2. 析局部分：\n   - 基于古籍智慧的逻辑分析\n   - 相关的历史典故或案例\n\n3. 行策部分：\n   - 核心策略建议\n   - 具体可操作的方法\n   - 风险提醒和注意事项\n\n请确保内容原创、深度、实用，体现古代智慧在现代问题中的应用。");let n=await y(e,s,t);return{探源:{原文:await a(s),出处:r(s),问题转述:e,深层分析:n.deepAnalysis},析局:{逻辑分析:n.logicAnalysis,历史案例:n.historicalCase},行策:{核心策略:n.coreStrategy,具体方法:n.detailedMethod,风险提醒:n.riskWarning}}}catch(n){return console.error("生成答案内容失败:",n),{探源:{原文:await a(s),出处:r(s),问题转述:e,深层分析:"您的问题反映了在复杂情况下寻求最佳解决方案的智慧需求。"},析局:{逻辑分析:"古人智慧告诉我们，面对挑战时需要深入分析局势，找到关键要素。",历史案例:"历史上许多智者都曾面临类似挑战，他们的经验值得我们借鉴。"},行策:{核心策略:"基于古代智慧，建议采用稳健而灵活的策略。",具体方法:"具体实施时，需要结合实际情况，循序渐进地推进。",风险提醒:"在执行过程中，需要时刻保持警觉，及时调整策略。"}}}},g=async e=>{try{let n=await fetch("/api/deepseek",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:e})});if(!n.ok)throw console.error("API调用失败:",n.status,n.statusText),Error("API调用失败: ".concat(n.status));return(await n.json()).content||"生成内容失败"}catch(n){if(console.error("DeepSeek API调用错误:",n),e.includes("问题概况"))return"这是一个关于策略决策的重要问题，需要综合考虑多个因素来制定最佳方案。";if(e.includes("核心分析"))return"通过深入分析问题的本质和关键要素，我们可以找到解决问题的核心路径。";if(e.includes("历史案例"))return"历史上类似的情况告诉我们，成功的关键在于准确判断形势并采取适当的行动。";if(e.includes("逻辑分析"))return"从逻辑角度分析，我们需要理清因果关系，找出问题的根源和解决方案。";else if(e.includes("高能摘要"))return"核心要点：抓住关键机会，制定明确策略，果断执行行动计划。";else if(e.includes("详细方法"))return"具体实施步骤：1. 深入调研分析 2. 制定行动方案 3. 分步骤执行 4. 持续优化调整";else if(e.includes("风险示警"))return"需要注意的风险：时机把握、资源配置、执行力度等关键因素可能影响最终效果。";return"智能分析生成中，请稍候..."}},y=async(e,n,t)=>{try{let s=n?n.书籍名称:"古代典籍",a=t&&t.length>0?t.join("、"):"综合智慧",r='用户问题："'.concat(e,'"\n参考古籍：').concat(s,"\n方略经纬：").concat(a,"\n\n请简洁概况用户问题的核心，并分析用户背后的真实困扰。要求：\n1. 用1-2句话概括问题核心\n2. 用1-2句话分析真实困扰\n3. 语言简洁有力，直击要害"),i=[g(r),A(e,n,t),j(e,n),N(e,n,t),p(e,n,t),v(e,n)],[c,o,l,u,_,d]=await Promise.allSettled(i);return{deepAnalysis:"fulfilled"===c.status?c.value:"问题核心在于决策困境，真实困扰是缺乏明确方向。",logicAnalysis:"fulfilled"===o.status?o.value:"古籍智慧指引方向，核心在于顺势而为。",historicalCase:"fulfilled"===l.status?l.value:"春秋时期，管仲辅佐齐桓公，面对内忧外患，不急于求成，而是先稳内政、后图霸业，最终成就一代霸主。",coreStrategy:"fulfilled"===u.status?u.value:"先稳后进，以静制动。明确目标，分步实施，借势而为，化危为机。",detailedMethod:"fulfilled"===_.status?_.value:"第一步：明确目标，理清思路。第二步：分析现状，找准问题根源。第三步：制定计划，分步实施。",riskWarning:"fulfilled"===d.status?d.value:"切忌急功近利，欲速则不达。过程中需防范利益冲突，保持初心不变。"}}catch(e){return console.error("生成智能答案时出错:",e),{deepAnalysis:"问题核心在于决策困境，真实困扰是缺乏明确方向。",logicAnalysis:"古籍智慧指引方向，核心在于顺势而为。",historicalCase:"春秋时期，管仲辅佐齐桓公，面对内忧外患，不急于求成，而是先稳内政、后图霸业，最终成就一代霸主。",coreStrategy:"先稳后进，以静制动。明确目标，分步实施，借势而为，化危为机。",detailedMethod:"第一步：明确目标，理清思路。第二步：分析现状，找准问题根源。第三步：制定计划，分步实施。",riskWarning:"切忌急功近利，欲速则不达。过程中需防范利益冲突，保持初心不变。"}}},A=async(e,n,t)=>{if(!n)return"古籍智慧指引方向，核心在于顺势而为。";let s="古籍：《".concat(n.书籍名称,'》\n用户问题："').concat(e,'"\n\n请用1-2句话简要拆解这本古籍中与用户问题相关的核心逻辑。要求：\n1. 直接点出书中的核心智慧\n2. 语言简洁有力\n3. 与用户问题紧密相关');return await g(s)||"《".concat(n.书籍名称,"》强调顺势而为，核心在于把握时机与人心。")},j=async(e,n)=>await g('用户问题："'.concat(e,'"\n\n请提供一个简短、生动、有画面感的真实历史案例来说明类似问题的解决之道。要求：\n1. 真实的历史人物和事件\n2. 与用户问题高度相关\n3. 语言生动有画面感\n4. 控制在100字以内\n5. 突出解决问题的智慧'))||"春秋时期，管仲辅佐齐桓公，面对内忧外患，不急于求成，而是先稳内政、后图霸业，最终成就一代霸主。其智慧在于：急事缓做，缓事急做。",N=async(e,n,t)=>{let s=t&&t.length>0?t.join("、"):"综合智慧",a='用户问题："'.concat(e,'"\n方略经纬：').concat(s,"\n\n请给出一个快准狠的高能摘要，作为解决问题的核心策略。要求：\n1. 语言简洁有力\n2. 直击问题要害\n3. 具有可操作性\n4. 控制在50字以内\n5. 体现古代智慧的精髓");return await g(a)||"先稳后进，以静制动。明确目标，分步实施，借势而为，化危为机。"},p=async(e,n,t)=>{let s=t&&t.length>0?t.join("、"):"综合智慧",a='用户问题："'.concat(e,'"\n方略经纬：').concat(s,"\n\n请详细给出解决方法，要求：\n1. 分步骤、有逻辑\n2. 具体可操作\n3. 结合古代智慧\n4. 语言简洁明了\n5. 控制在200字以内");return await g(a)||"第一步：明确目标，理清思路。第二步：分析现状，找准问题根源。第三步：制定计划，分步实施。第四步：调动资源，凝聚力量。第五步：持续跟进，及时调整。关键在于稳扎稳打，步步为营。"},v=async(e,n)=>await g('用户问题："'.concat(e,'"\n\n请给出一个简短的示警，提醒用户在解决问题过程中需要注意的风险。要求：\n1. 语言简洁有力\n2. 直指关键风险\n3. 具有警示作用\n4. 控制在50字以内\n5. 体现古代智慧的谨慎'))||"切忌急功近利，欲速则不达。过程中需防范利益冲突，保持初心不变。",T=async(e,n)=>{if(!n)return{text:"智者顺时而谋，愚者逆势而动。",source:"古代智慧"};let t="古籍：《".concat(n.书籍名称,'》\n用户问题："').concat(e,'"\n\n请从这本古籍的智慧中，选择或生成一句与用户问题高度相关的经典语录。要求：\n1. 语言简洁有力\n2. 与问题高度相关\n3. 体现古代智慧\n4. 控制在30字以内');return{text:await g(t)||"知己知彼，百战不殆。",source:n.书籍名称}};return u?(0,s.jsx)("div",{className:c().container,children:(0,s.jsxs)("div",{className:c().loading,children:[(0,s.jsx)("div",{className:c().loadingSpinner,"data-progress":"".concat(w,"%")}),(0,s.jsx)("p",{children:"方略近在眼前..."})]})}):d?(0,s.jsx)("div",{className:c().container,children:(0,s.jsxs)("div",{className:c().error,children:[(0,s.jsx)("h2",{children:"生成答案时出现错误"}),(0,s.jsx)("p",{children:d}),(0,s.jsx)("button",{onClick:()=>e.back(),className:c().backButton,children:"返回重试"})]})}):(0,s.jsxs)("div",{className:c().container,children:[(0,s.jsxs)("nav",{className:c().navbar,children:[(0,s.jsx)("div",{className:c().brand,onClick:()=>e.push("/"),style:{cursor:"pointer"},children:"方略 Fanglue"}),(0,s.jsx)("div",{className:c().navLinks,children:(0,s.jsx)("button",{className:c().authBtn,children:"注册/登录"})})]}),(0,s.jsx)("main",{className:c().mainContent,children:i&&(0,s.jsxs)("article",{className:c().answerContainer,children:[(0,s.jsxs)("section",{className:c().section,children:[(0,s.jsxs)("h2",{className:c().sectionTitle,children:[(0,s.jsx)("img",{src:"/icons/explore-source.svg",alt:"探源",className:c().sectionIcon}),"探源"]}),(0,s.jsxs)("blockquote",{className:c().quote,children:[(0,s.jsxs)("p",{className:c().quoteText,children:['"',i.探源.原文,'"']}),(0,s.jsxs)("cite",{className:c().quoteSource,children:["- ",i.探源.出处]})]}),(0,s.jsxs)("div",{className:c().analysis,children:[(0,s.jsx)("p",{className:c().questionRestate,children:i.探源.问题转述}),(0,s.jsx)("p",{className:c().deepAnalysis,children:i.探源.深层分析})]})]}),(0,s.jsxs)("section",{className:c().section,children:[(0,s.jsxs)("h2",{className:c().sectionTitle,children:[(0,s.jsx)("img",{src:"/icons/analyze-situation.svg",alt:"析局",className:c().sectionIcon}),"析局"]}),(0,s.jsx)("p",{className:c().logicAnalysis,children:i.析局.逻辑分析}),(0,s.jsx)("aside",{className:c().historicalCase,children:(0,s.jsx)("p",{className:c().caseText,children:i.析局.历史案例})})]}),(0,s.jsxs)("section",{className:c().section,children:[(0,s.jsxs)("h2",{className:c().sectionTitle,children:[(0,s.jsx)("img",{src:"/icons/execute-strategy.svg",alt:"行策",className:c().sectionIcon}),"行策"]}),(0,s.jsx)("p",{className:c().strategyHighlight,children:i.行策.核心策略}),(0,s.jsx)("p",{className:c().methodText,children:i.行策.具体方法}),(0,s.jsx)("p",{className:c().warningText,children:i.行策.风险提醒})]})]})}),(0,s.jsxs)("footer",{className:c().footerSection,children:[(0,s.jsx)("div",{className:c().footerTitle,children:"让千载经略，为你今日一策"}),(0,s.jsxs)("div",{className:c().footerButtons,children:[(0,s.jsx)("a",{href:"#",className:c().footerBtn,title:"功能开发中，敬请期待",children:"众议百解"}),(0,s.jsx)("a",{href:"#",className:c().footerBtn,title:"功能开发中，敬请期待",children:"一日一策"}),(0,s.jsx)("a",{href:"#",className:c().footerBtn,title:"功能开发中，敬请期待",children:"历问历答"})]})]})]})}},2749:function(e){e.exports={container:"Answer_container__sZElH",navbar:"Answer_navbar__84uBn",brand:"Answer_brand__F0G_T",navLinks:"Answer_navLinks__UM0ps",navLink:"Answer_navLink__UUfnZ",authBtn:"Answer_authBtn__T7hHn",mainContent:"Answer_mainContent__BYWrB",questionSection:"Answer_questionSection__GgARw",questionTitle:"Answer_questionTitle__OqVYn",questionText:"Answer_questionText__rSCS9",answerContainer:"Answer_answerContainer__QaDzU",section:"Answer_section__5gx4O",sectionTitle:"Answer_sectionTitle__cUVEu",sectionIcon:"Answer_sectionIcon__vJmVl",sectionContent:"Answer_sectionContent__9BHcE",quote:"Answer_quote__ximbz",quoteText:"Answer_quoteText__ZCa1F",quoteSource:"Answer_quoteSource__3m_JY",analysis:"Answer_analysis__I0JQE",questionRestate:"Answer_questionRestate__Ju_bk",deepAnalysis:"Answer_deepAnalysis__KTJRJ",logicAnalysis:"Answer_logicAnalysis__jCSP2",historicalCase:"Answer_historicalCase__1f8lJ",caseText:"Answer_caseText__nF_RY",coreStrategy:"Answer_coreStrategy__1D01F",strategyHighlight:"Answer_strategyHighlight__jFdtK",detailedMethod:"Answer_detailedMethod__7QLR_",methodText:"Answer_methodText__XKkz8",riskWarning:"Answer_riskWarning__EgZXX",warningText:"Answer_warningText__2EvVD",loading:"Answer_loading__pGSXr",loadingSpinner:"Answer_loadingSpinner__0jss9",spin:"Answer_spin__VjJzd",counterRotate:"Answer_counterRotate__pLkW5",error:"Answer_error__NiLdL",backButton:"Answer_backButton__iKUmo",footerSection:"Answer_footerSection__AYNLu",footerTitle:"Answer_footerTitle__eHdL1",footerButtons:"Answer_footerButtons__zVgA5",footerBtn:"Answer_footerBtn__08cMQ"}},1163:function(e,n,t){e.exports=t(2937)}},function(e){e.O(0,[608,774,888,179],function(){return e(e.s=361)}),_N_E=e.O()}]);