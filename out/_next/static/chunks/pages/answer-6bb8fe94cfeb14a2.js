(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[878],{361:function(e,n,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/answer",function(){return s(6491)}])},5981:function(e,n,s){"use strict";s.d(n,{Y:function(){return a}});let t=(0,s(1608).eI)("https://crnfwlpcxrnqfgwqnmun.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNybmZ3bHBjeHJucWZnd3FubXVuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUxNTAzMDQsImV4cCI6MjA3MDcyNjMwNH0.g_HmFQQiuGW2TZRzZ5gqCj098DZy6iwn_xQAE6kEUEI"),a={supabase:t,async insert(e,n){let{data:s,error:a}=await t.from(e).insert(n).select();if(a)throw console.error("插入数据错误:",a),a;return s},async select(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=t.from(e).select("*");Object.entries(n).forEach(e=>{let[n,t]=e;s=s.eq(n,t)});let{data:a,error:r}=await s;if(r)throw console.error("查询数据错误:",r),r;return a},async update(e,n,s){let{data:a,error:r}=await t.from(e).update(s).eq("id",n).select();if(r)throw console.error("更新数据错误:",r),r;return a},async delete(e,n){let{error:s}=await t.from(e).delete().eq("id",n);if(s)throw console.error("删除数据错误:",s),s;return!0},async testConnection(){try{let{data:e,error:n}=await t.rpc("version");if(n){let{error:e}=await t.from("test_connection_table").select("*").limit(1);if(e&&("PGRST116"===e.code||"42P01"===e.code))return console.log("数据库连接成功!"),!0;return console.error("数据库连接测试失败:",e||n),!1}return console.log("数据库连接成功!"),!0}catch(e){return console.error("连接测试异常:",e),!1}}}},6491:function(e,n,s){"use strict";s.r(n),s.d(n,{default:function(){return o}});var t=s(5893),a=s(7294),r=s(1163),i=s(2749),c=s.n(i),l=s(5981);function o(){let e=(0,r.useRouter)(),{question:n,strategies:s}=e.query,[i,o]=(0,a.useState)(null),[u,_]=(0,a.useState)(!0),[d,h]=(0,a.useState)(null);(0,a.useEffect)(()=>{n&&w()},[n,s]);let w=async()=>{_(!0),h(null);try{let e=s?s.split(","):[],t=[];if(e&&e.length>0){let{data:n,error:s}=await l.Y.supabase.from("book_library").select("*").in("strategy_category",e);s?(console.error("查询书籍数据失败:",s),t=[]):t=n||[]}else{let{data:e,error:n}=await l.Y.supabase.from("book_library").select("*");n?(console.error("查询书籍数据失败:",n),t=[]):t=e||[]}let a=await f(n,t,e);o(a)}catch(e){console.error("生成答案失败:",e),h("生成答案时出现错误，请稍后重试。")}finally{_(!1)}},f=async(e,n,s)=>{let t=n&&n.length>0?n[Math.floor(Math.random()*n.length)]:null,a=async n=>n&&n.章节内容&&"string"==typeof n.章节内容?(await N(e,n)).text:"古人云：'知己知彼，百战不殆。'",r=e=>e&&e.书籍名称&&e.章节名称?"《".concat(e.书籍名称,"\xb7").concat(e.章节名称,"》"):"《古代典籍》";try{"请基于以下信息生成一个结构化的智慧解答：\n\n用户问题：".concat(e,"\n\n选择的方略经纬：").concat(s&&s.length>0?s.join("、"):"无特定方向","\n\n引用书籍：").concat(t?"《".concat(t.书籍名称,"》"):"古代典籍","\n书籍内容：").concat(t?t.章节内容:"古代智慧典籍","\n\n请按照以下结构生成答案，每部分都要有实质性内容，不要使用模板化语言：\n\n1. 探源部分：\n   - 从书籍中提取1-3句相关原文\n   - 深层分析用户问题背后的真实困扰（使用第二人称）\n\n2. 析局部分：\n   - 基于古籍智慧的逻辑分析\n   - 相关的历史典故或案例\n\n3. 行策部分：\n   - 核心策略建议\n   - 具体可操作的方法\n   - 风险提醒和注意事项\n\n请确保内容原创、深度、实用，体现古代智慧在现代问题中的应用。");let n=await x(e,t,s);return{探源:{原文:await a(t),出处:r(t),问题转述:e,深层分析:n.deepAnalysis},析局:{逻辑分析:n.logicAnalysis,历史案例:n.historicalCase},行策:{核心策略:n.coreStrategy,具体方法:n.detailedMethod,风险提醒:n.riskWarning}}}catch(n){return console.error("生成答案内容失败:",n),{探源:{原文:await a(t),出处:r(t),问题转述:e,深层分析:"您的问题反映了在复杂情况下寻求最佳解决方案的智慧需求。"},析局:{逻辑分析:"古人智慧告诉我们，面对挑战时需要深入分析局势，找到关键要素。",历史案例:"历史上许多智者都曾面临类似挑战，他们的经验值得我们借鉴。"},行策:{核心策略:"基于古代智慧，建议采用稳健而灵活的策略。",具体方法:"具体实施时，需要结合实际情况，循序渐进地推进。",风险提醒:"在执行过程中，需要时刻保持警觉，及时调整策略。"}}}},m=async e=>{try{let n=await fetch("/api/deepseek",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:e})});if(!n.ok)throw console.error("API调用失败:",n.status,n.statusText),Error("API调用失败: ".concat(n.status));return(await n.json()).content||"生成内容失败"}catch(n){if(console.error("DeepSeek API调用错误:",n),e.includes("问题概况"))return"这是一个关于策略决策的重要问题，需要综合考虑多个因素来制定最佳方案。";if(e.includes("核心分析"))return"通过深入分析问题的本质和关键要素，我们可以找到解决问题的核心路径。";if(e.includes("历史案例"))return"历史上类似的情况告诉我们，成功的关键在于准确判断形势并采取适当的行动。";if(e.includes("逻辑分析"))return"从逻辑角度分析，我们需要理清因果关系，找出问题的根源和解决方案。";else if(e.includes("高能摘要"))return"核心要点：抓住关键机会，制定明确策略，果断执行行动计划。";else if(e.includes("详细方法"))return"具体实施步骤：1. 深入调研分析 2. 制定行动方案 3. 分步骤执行 4. 持续优化调整";else if(e.includes("风险示警"))return"需要注意的风险：时机把握、资源配置、执行力度等关键因素可能影响最终效果。";return"智能分析生成中，请稍候..."}},x=async(e,n,s)=>{try{let t=n?n.书籍名称:"古代典籍",a=s&&s.length>0?s.join("、"):"综合智慧",r='用户问题："'.concat(e,'"\n参考古籍：').concat(t,"\n方略经纬：").concat(a,"\n\n请简洁概况用户问题的核心，并分析用户背后的真实困扰。要求：\n1. 用1-2句话概括问题核心\n2. 用1-2句话分析真实困扰\n3. 语言简洁有力，直击要害"),i=[m(r),y(e,n,s),g(e,n),j(e,n,s),A(e,n,s),p(e,n)],[c,l,o,u,_,d]=await Promise.allSettled(i);return{deepAnalysis:"fulfilled"===c.status?c.value:"问题核心在于决策困境，真实困扰是缺乏明确方向。",logicAnalysis:"fulfilled"===l.status?l.value:"古籍智慧指引方向，核心在于顺势而为。",historicalCase:"fulfilled"===o.status?o.value:"春秋时期，管仲辅佐齐桓公，面对内忧外患，不急于求成，而是先稳内政、后图霸业，最终成就一代霸主。",coreStrategy:"fulfilled"===u.status?u.value:"先稳后进，以静制动。明确目标，分步实施，借势而为，化危为机。",detailedMethod:"fulfilled"===_.status?_.value:"第一步：明确目标，理清思路。第二步：分析现状，找准问题根源。第三步：制定计划，分步实施。",riskWarning:"fulfilled"===d.status?d.value:"切忌急功近利，欲速则不达。过程中需防范利益冲突，保持初心不变。"}}catch(e){return console.error("生成智能答案时出错:",e),{deepAnalysis:"问题核心在于决策困境，真实困扰是缺乏明确方向。",logicAnalysis:"古籍智慧指引方向，核心在于顺势而为。",historicalCase:"春秋时期，管仲辅佐齐桓公，面对内忧外患，不急于求成，而是先稳内政、后图霸业，最终成就一代霸主。",coreStrategy:"先稳后进，以静制动。明确目标，分步实施，借势而为，化危为机。",detailedMethod:"第一步：明确目标，理清思路。第二步：分析现状，找准问题根源。第三步：制定计划，分步实施。",riskWarning:"切忌急功近利，欲速则不达。过程中需防范利益冲突，保持初心不变。"}}},y=async(e,n,s)=>{if(!n)return"古籍智慧指引方向，核心在于顺势而为。";let t="古籍：《".concat(n.书籍名称,'》\n用户问题："').concat(e,'"\n\n请用1-2句话简要拆解这本古籍中与用户问题相关的核心逻辑。要求：\n1. 直接点出书中的核心智慧\n2. 语言简洁有力\n3. 与用户问题紧密相关');return await m(t)||"《".concat(n.书籍名称,"》强调顺势而为，核心在于把握时机与人心。")},g=async(e,n)=>await m('用户问题："'.concat(e,'"\n\n请提供一个简短、生动、有画面感的真实历史案例来说明类似问题的解决之道。要求：\n1. 真实的历史人物和事件\n2. 与用户问题高度相关\n3. 语言生动有画面感\n4. 控制在100字以内\n5. 突出解决问题的智慧'))||"春秋时期，管仲辅佐齐桓公，面对内忧外患，不急于求成，而是先稳内政、后图霸业，最终成就一代霸主。其智慧在于：急事缓做，缓事急做。",j=async(e,n,s)=>{let t=s&&s.length>0?s.join("、"):"综合智慧",a='用户问题："'.concat(e,'"\n方略经纬：').concat(t,"\n\n请给出一个快准狠的高能摘要，作为解决问题的核心策略。要求：\n1. 语言简洁有力\n2. 直击问题要害\n3. 具有可操作性\n4. 控制在50字以内\n5. 体现古代智慧的精髓");return await m(a)||"先稳后进，以静制动。明确目标，分步实施，借势而为，化危为机。"},A=async(e,n,s)=>{let t=s&&s.length>0?s.join("、"):"综合智慧",a='用户问题："'.concat(e,'"\n方略经纬：').concat(t,"\n\n请详细给出解决方法，要求：\n1. 分步骤、有逻辑\n2. 具体可操作\n3. 结合古代智慧\n4. 语言简洁明了\n5. 控制在200字以内");return await m(a)||"第一步：明确目标，理清思路。第二步：分析现状，找准问题根源。第三步：制定计划，分步实施。第四步：调动资源，凝聚力量。第五步：持续跟进，及时调整。关键在于稳扎稳打，步步为营。"},p=async(e,n)=>await m('用户问题："'.concat(e,'"\n\n请给出一个简短的示警，提醒用户在解决问题过程中需要注意的风险。要求：\n1. 语言简洁有力\n2. 直指关键风险\n3. 具有警示作用\n4. 控制在50字以内\n5. 体现古代智慧的谨慎'))||"切忌急功近利，欲速则不达。过程中需防范利益冲突，保持初心不变。",N=async(e,n)=>{if(!n)return{text:"智者顺时而谋，愚者逆势而动。",source:"古代智慧"};let s="古籍：《".concat(n.书籍名称,'》\n用户问题："').concat(e,'"\n\n请从这本古籍的智慧中，选择或生成一句与用户问题高度相关的经典语录。要求：\n1. 语言简洁有力\n2. 与问题高度相关\n3. 体现古代智慧\n4. 控制在30字以内');return{text:await m(s)||"知己知彼，百战不殆。",source:n.书籍名称}};return u?(0,t.jsx)("div",{className:c().container,children:(0,t.jsxs)("div",{className:c().loading,children:[(0,t.jsx)("div",{className:c().loadingSpinner}),(0,t.jsx)("p",{children:"正在为您生成方略解答..."})]})}):d?(0,t.jsx)("div",{className:c().container,children:(0,t.jsxs)("div",{className:c().error,children:[(0,t.jsx)("h2",{children:"生成答案时出现错误"}),(0,t.jsx)("p",{children:d}),(0,t.jsx)("button",{onClick:()=>e.back(),className:c().backButton,children:"返回重试"})]})}):(0,t.jsxs)("div",{className:c().container,children:[(0,t.jsxs)("nav",{className:c().navbar,children:[(0,t.jsx)("div",{className:c().brand,children:"方略 Fanglue"}),(0,t.jsxs)("div",{className:c().navLinks,children:[(0,t.jsx)("button",{onClick:()=>e.back(),className:c().navLink,children:"返回提问"}),(0,t.jsx)("a",{href:"/",className:c().navLink,children:"返回首页"})]})]}),(0,t.jsx)("main",{className:c().mainContent,children:i&&(0,t.jsxs)("article",{className:c().answerContainer,children:[(0,t.jsxs)("section",{className:c().section,children:[(0,t.jsx)("h2",{className:c().sectionTitle,children:"探源"}),(0,t.jsxs)("blockquote",{className:c().quote,children:[(0,t.jsxs)("p",{className:c().quoteText,children:['"',i.探源.原文,'"']}),(0,t.jsxs)("cite",{className:c().quoteSource,children:["- ",i.探源.出处]})]}),(0,t.jsxs)("div",{className:c().analysis,children:[(0,t.jsx)("p",{className:c().questionRestate,children:i.探源.问题转述}),(0,t.jsx)("p",{className:c().deepAnalysis,children:i.探源.深层分析})]})]}),(0,t.jsxs)("section",{className:c().section,children:[(0,t.jsx)("h2",{className:c().sectionTitle,children:"析局"}),(0,t.jsx)("p",{className:c().logicAnalysis,children:i.析局.逻辑分析}),(0,t.jsx)("aside",{className:c().historicalCase,children:(0,t.jsx)("p",{className:c().caseText,children:i.析局.历史案例})})]}),(0,t.jsxs)("section",{className:c().section,children:[(0,t.jsx)("h2",{className:c().sectionTitle,children:"行策"}),(0,t.jsx)("p",{className:c().strategyHighlight,children:i.行策.核心策略}),(0,t.jsx)("p",{className:c().methodText,children:i.行策.具体方法}),(0,t.jsx)("p",{className:c().warningText,children:i.行策.风险提醒})]})]})}),(0,t.jsx)("footer",{className:c().footer,children:(0,t.jsx)("p",{children:"\xa9 2024 方略 Fanglue - 让千载经略，为你今日一策"})})]})}},2749:function(e){e.exports={container:"Answer_container__sZElH",navbar:"Answer_navbar__84uBn",brand:"Answer_brand__F0G_T",navLinks:"Answer_navLinks__UM0ps",navLink:"Answer_navLink__UUfnZ",mainContent:"Answer_mainContent__BYWrB",questionSection:"Answer_questionSection__GgARw",questionTitle:"Answer_questionTitle__OqVYn",questionText:"Answer_questionText__rSCS9",answerContainer:"Answer_answerContainer__QaDzU",section:"Answer_section__5gx4O",sectionTitle:"Answer_sectionTitle__cUVEu",sectionContent:"Answer_sectionContent__9BHcE",quote:"Answer_quote__ximbz",quoteText:"Answer_quoteText__ZCa1F",quoteSource:"Answer_quoteSource__3m_JY",analysis:"Answer_analysis__I0JQE",questionRestate:"Answer_questionRestate__Ju_bk",deepAnalysis:"Answer_deepAnalysis__KTJRJ",logicAnalysis:"Answer_logicAnalysis__jCSP2",historicalCase:"Answer_historicalCase__1f8lJ",caseText:"Answer_caseText__nF_RY",coreStrategy:"Answer_coreStrategy__1D01F",strategyHighlight:"Answer_strategyHighlight__jFdtK",detailedMethod:"Answer_detailedMethod__7QLR_",methodText:"Answer_methodText__XKkz8",riskWarning:"Answer_riskWarning__EgZXX",warningText:"Answer_warningText__2EvVD",loading:"Answer_loading__pGSXr",loadingSpinner:"Answer_loadingSpinner__0jss9",spin:"Answer_spin__VjJzd",error:"Answer_error__NiLdL",backButton:"Answer_backButton__iKUmo",footer:"Answer_footer__8hEJ3"}},1163:function(e,n,s){e.exports=s(2937)}},function(e){e.O(0,[608,774,888,179],function(){return e(e.s=361)}),_N_E=e.O()}]);