(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[721],{7699:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/ask",function(){return s(5146)}])},5981:function(e,t,s){"use strict";s.d(t,{Y:function(){return r}});let n=(0,s(1608).eI)("https://crnfwlpcxrnqfgwqnmun.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNybmZ3bHBjeHJucWZnd3FubXVuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUxNTAzMDQsImV4cCI6MjA3MDcyNjMwNH0.g_HmFQQiuGW2TZRzZ5gqCj098DZy6iwn_xQAE6kEUEI"),r={supabase:n,async insert(e,t){let{data:s,error:r}=await n.from(e).insert(t).select();if(r)throw console.error("插入数据错误:",r),r;return s},async select(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=n.from(e).select("*");Object.entries(t).forEach(e=>{let[t,n]=e;s=s.eq(t,n)});let{data:r,error:a}=await s;if(a)throw console.error("查询数据错误:",a),a;return r},async update(e,t,s){let{data:r,error:a}=await n.from(e).update(s).eq("id",t).select();if(a)throw console.error("更新数据错误:",a),a;return r},async delete(e,t){let{error:s}=await n.from(e).delete().eq("id",t);if(s)throw console.error("删除数据错误:",s),s;return!0},async testConnection(){try{let{data:e,error:t}=await n.rpc("version");if(t){let{error:e}=await n.from("test_connection_table").select("*").limit(1);if(e&&("PGRST116"===e.code||"42P01"===e.code))return console.log("数据库连接成功!"),!0;return console.error("数据库连接测试失败:",e||t),!1}return console.log("数据库连接成功!"),!0}catch(e){return console.error("连接测试异常:",e),!1}}}},5146:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return c}});var n=s(5893),r=s(7294),a=s(8339),i=s.n(a),o=s(5981);function c(){let[e,t]=(0,r.useState)(""),[s,a]=(0,r.useState)(!1),[c,l]=(0,r.useState)(""),[_,d]=(0,r.useState)("未连接"),[u,h]=(0,r.useState)([]);(0,r.useEffect)(()=>{(async()=>{try{let e=await o.Y.testConnection();d(e?"已连接":"连接失败")}catch(e){d("连接错误"),console.error("数据库连接测试失败:",e)}})()},[]);let m=e=>{h(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},k=async t=>{if(t.preventDefault(),e.trim()){a(!0);try{let t=u.length>0?u.join(","):"",s=new URLSearchParams({question:e,...t&&{strategies:t}});window.location.href="/answer?".concat(s.toString())}catch(e){console.error("提交失败:",e),a(!1)}}};return(0,n.jsxs)("div",{className:i().container,children:[(0,n.jsxs)("nav",{className:i().navbar,children:[(0,n.jsx)("div",{className:i().brand,onClick:()=>window.location.href="/",style:{cursor:"pointer"},children:"方略 Fanglue"}),(0,n.jsx)("div",{className:i().navLinks,children:(0,n.jsx)("button",{className:i().authBtn,children:"注册/登录"})})]}),(0,n.jsxs)("main",{className:i().mainContent,children:[(0,n.jsxs)("div",{className:i().header,children:[(0,n.jsx)("h1",{className:i().title,children:"问古今，寻方略"}),(0,n.jsx)("p",{className:i().subtitle,children:"让千载经略，为你今日一策"})]}),(0,n.jsxs)("form",{onSubmit:k,className:i().questionForm,children:[(0,n.jsx)("div",{className:i().inputGroup,children:(0,n.jsx)("textarea",{value:e,onChange:e=>t(e.target.value),placeholder:"请输入您的问题...",className:i().questionInput,rows:6,disabled:s})}),(0,n.jsxs)("div",{className:i().strategySection,children:[(0,n.jsx)("h3",{className:i().strategyTitle,children:"方略经纬"}),(0,n.jsx)("p",{className:i().strategySubtitle,children:"您希望从哪些方面获得解答？（可单选或多选，如果不选，将自动为您搜索最优策略）"}),(0,n.jsx)("div",{className:i().strategyGrid,children:[{id:"行正持礼",label:"行正持礼"},{id:"顺势而为",label:"顺势而为"},{id:"巧谋实战",label:"巧谋实战"},{id:"运筹帷幄",label:"运筹帷幄"}].map(e=>(0,n.jsx)("div",{className:"".concat(i().strategyOption," ").concat(u.includes(e.id)?i().selected:""),onClick:()=>m(e.id),children:(0,n.jsxs)("div",{className:i().strategyCheckbox,children:[(0,n.jsx)("input",{type:"checkbox",id:e.id,checked:u.includes(e.id),onChange:()=>m(e.id),className:i().checkbox}),(0,n.jsx)("label",{htmlFor:e.id,className:i().checkboxLabel,children:(0,n.jsx)("div",{className:i().strategyLabel,children:e.label})})]})},e.id))})]}),(0,n.jsx)("button",{type:"submit",className:"".concat(i().submitButton," ").concat(s?i().loading:""),disabled:!e.trim()||s,children:s?"处理中...":"立即寻索"})]}),c&&(0,n.jsxs)("div",{className:i().answerSection,children:[(0,n.jsx)("h3",{className:i().answerTitle,children:"方略解答"}),(0,n.jsx)("div",{className:i().answerContent,children:c})]})]}),(0,n.jsxs)("footer",{className:i().footerSection,children:[(0,n.jsx)("div",{className:i().footerTitle,children:"让千载经略，为你今日一策"}),(0,n.jsxs)("div",{className:i().footerButtons,children:[(0,n.jsx)("a",{href:"#",className:i().footerBtn,title:"功能开发中，敬请期待",children:"众议百解"}),(0,n.jsx)("a",{href:"#",className:i().footerBtn,title:"功能开发中，敬请期待",children:"一日一策"}),(0,n.jsx)("a",{href:"#",className:i().footerBtn,title:"功能开发中，敬请期待",children:"历问历答"})]})]})]})}},8339:function(e){e.exports={container:"Ask_container__K8Er4",navbar:"Ask_navbar__nZK1Y",brand:"Ask_brand__kNLBD",navLinks:"Ask_navLinks__dRjsn",authBtn:"Ask_authBtn__l2xrS",mainContent:"Ask_mainContent__AMGTl",header:"Ask_header__PTw99",title:"Ask_title__omFmW",subtitle:"Ask_subtitle__hitrC",questionForm:"Ask_questionForm__WUnSJ",inputGroup:"Ask_inputGroup__epmN7",questionInput:"Ask_questionInput__oIowT",strategySection:"Ask_strategySection__bOqWF",strategyTitle:"Ask_strategyTitle__V9Cn_",strategySubtitle:"Ask_strategySubtitle__K2DYa",strategyGrid:"Ask_strategyGrid__CqRp9",strategyOption:"Ask_strategyOption__bkvtG",selected:"Ask_selected__7JCMj",strategyCheckbox:"Ask_strategyCheckbox__tr7B_",checkbox:"Ask_checkbox__hl8gQ",checkboxLabel:"Ask_checkboxLabel__64Jur",strategyLabel:"Ask_strategyLabel__J_FWp",submitButton:"Ask_submitButton__tig4h",loading:"Ask_loading___q74m",progressBar:"Ask_progressBar__2yGF1",progressFill:"Ask_progressFill__fkxfB",progressText:"Ask_progressText__Os8pk",footerSection:"Ask_footerSection__EN4Qi",footerTitle:"Ask_footerTitle__e76h_",footerButtons:"Ask_footerButtons__JX7La",footerBtn:"Ask_footerBtn__luBWq"}}},function(e){e.O(0,[608,774,888,179],function(){return e(e.s=7699)}),_N_E=e.O()}]);